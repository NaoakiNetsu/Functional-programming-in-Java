<!-- TOC -->autoauto- [現場で役立つシステム設計の原則](#現場で役立つシステム設計の原則)auto        - [前提条件（本書籍の目的）](#前提条件本書籍の目的)auto    - [Chapter 1：小さくまとめてわかりやすくする](#chapter-1小さくまとめてわかりやすくする)auto        - [業務アプリケーションにおけるクラス設計](#業務アプリケーションにおけるクラス設計)auto            - [ドメインオブジェクト　p. 26付近](#ドメインオブジェクト　p-26付近)auto            - [値オブジェクト　p. 32付近](#値オブジェクト　p-32付近)autoauto<!-- /TOC -->

# 現場で役立つシステム設計の原則

個人的にいいなと思ったり勉強になった部分だけピックアップしてまとめる。

### 前提条件（本書籍の目的）
オブジェクト指向の考え方を用いてソフトウェアを設計できるようになること。

## Chapter 1：小さくまとめてわかりやすくする

### 業務アプリケーションにおけるクラス設計

#### ドメインオブジェクト　p. 26付近
業務で使われる用語に合わせて、その用語の関心事に直接対応するクラス、**ドメインオブジェクト**を用意することが、業務アプリケーションの変更を容易にするオブジェクト指向的な設計のアプローチである。

ドメインオブジェクト毎に独立させておくことで、**変更の対象と影響範囲を限定することができ**、将来の変更も容易となる。

#### 値オブジェクト　p. 32付近
業務アプリケーションをオブジェクト指向で設計する場合には、業務で扱うデータの種類毎に専用のクラス、**値オブジェクト(Value Object)** を用意する。

■値オブジェクトの例

値オブジェクト|内容
:--|:--
Quantity|数量（と単位）
Amount|金額
Money|金額と通貨
Days|日付
Hours|時間
Telephone|電話番号
Email|メールアドレス
Url|URL

など。

専用の型を持つことで業務的に不適切な値が混入するバグを防ぐことができる。
通常のintやStringは業務に関する関心事ではないが、QuantityやMoneyは業務関心そのものを表現するので、**業務の理解とプログラムの設計を直接的に関連付けることができ**、整理された変更が楽で安全なプログラムを作ることができる。

値オブジェクトの具体的なルールは以下の通り。
* インスタンス変数はコンストラクタでオブジェクトの生成時に設定する。
* インスタンス変数を変更するメソッド(setter)を作らない。
* 別の値が必要であれば、別のインスタンスを作る

このような設計のやり方を**完全コンストラクタ**と呼ぶ。

```java
// 完全コンストラクタで設計されたMoneyオブジェクトを使う。
Money basePrice = new Money(3000);
Money discounted = basePrise.minus(1000); // 金額を割引したい場合、割引された金額を保持する新しいMoneyオブジェクトを作る。
// minus()メソッドは別のMoneyオブジェクトを作成して返す

Money option = new Money(1000) // 別の値が必要になったら新しいMoneyオブジェクトを作成する
```

★参考文献  
[値オブジェクトとコレクションオブジェクト](http://blog.sojiro.me/blog/2017/08/25/value-object-and-collection-object/)

↑のブログに記載されていた「これらはサーバーリクエストの口でバリデーションを通るものの、その後の値がアプリケーションコード内で保証されないため非常に不安定だった。」はまったくもってその通りだと思った。ダブルチェックしてサーバ側の処理に入ってきても、結局不正な値になる可能性はあるので。
